---
title: Redis常见面试题
date: 2020-08-30
categories:
 - article
author:
---
## Redis常见面试题

### 分布式锁的问题：

1. ​	setNX命令
2.   死锁（异常或者是宕机等等）：需要设置超时时间  set  ex nx 
3. 超时执行解锁导致并发：执行超时，锁已经释放，设置守护线程，续期超时时间
4. 锁错误解除：t1执行超时，锁释放，t2线程获取锁，当t1执行完成，去释放了t2的锁
5. 不可重入 

### Redis持久化机制

1. RDB 快照文件，  恢复较快，但是丢失数据严重

2. AOF 以追加的方式加入日志文件   实时，但是恢复的时候比较慢

   原理：fork一个子进程，子进程将父进程的数据复制到子进程的内存中，然后写入到临时文件，持久化结束后，用临时文件替换上次的快照文件

### 缓存雪崩、缓存穿透、缓存预热、缓存更新、缓存降级

1. 缓存雪崩：缓存失效、大量请求直接访问数据库，导致数据库宕机，引起整个系统的瘫痪
   加锁、或者是队列的形式避免大量请求直接访问数据库
2. 缓存穿透：缓存命中，多次缓存数据库中没有的数据。 采用布隆过滤器：将可能存在的结果都放到一个大的bitmap中
3. 缓存击穿：当一个数据是热点数据，当失效时有大量请求访问，击穿缓存，直接访问数据库
   解决办法：显示setnx来设置一个短期的key来锁住
4. 将相关缓存先缓存一份缓存中
   定时刷新
5. 热点数据：热点数据缓存才有意义

### Memcache和Redis的区别

1. redis可以持久化
2. redis支持更多的数据结构
3. redis单线程

### Redis单线程但是还是很快的原因

1. 基于内存操作
2. 避免了上下文切换
3. 使用非阻塞nio的多路复用机制